df = pd.read_csv("Mall_Customers.csv")
X = df[['Annual Income (k$)', 'Spending Score (1-100)']].values

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

Z = linkage(X_scaled, method='ward')

# Dendrogram
plt.figure(figsize=(10,5))
dendrogram(Z)
plt.title("Customer Segmentation Dendrogram")
plt.show()

cluster_labels = fcluster(Z, t=4, criterion='maxclust')
df['Cluster'] = cluster_labels
print(df.head())
